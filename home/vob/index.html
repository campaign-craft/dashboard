<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Ad Builder - Modern Edition</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --primary-hover: #4f46e5;
            --secondary: #06b6d4;
            --success: #10b981;
            --bg-gradient: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            --card-bg: #ffffff;
            --text-main: #1e293b;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            background: var(--bg-gradient);
            color: var(--text-main);
            min-height: 100vh;
            padding: 2rem 1rem;
            display: flex;
            justify-content: center;
        }

        .container {
            max-width: 1100px;
            width: 100%;
        }

        .header {
            text-align: center;
            margin-bottom: 2.5rem;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .header p {
            color: var(--text-muted);
            font-size: 1.1rem;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1.2fr 0.8fr;
            gap: 2rem;
            align-items: start;
        }

        .card {
            background: var(--card-bg);
            border-radius: 1.25rem;
            padding: 2rem;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .card h2 {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-main);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text-main);
        }

        input[type="text"],
        input[type="url"],
        select {
            width: 100%;
            padding: 0.75rem 1rem;
            border-radius: 0.75rem;
            border: 1.5px solid var(--border);
            background: #fdfdfd;
            font-size: 0.95rem;
            transition: all 0.2s;
            color: var(--text-main);
            outline: none;
        }

        input:focus, select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
            background: #fff;
        }

        /* Custom File Input */
        input[type="file"] {
            width: 100%;
            padding: 0.5rem;
            border-radius: 0.75rem;
            border: 1.5px dashed var(--border);
            cursor: pointer;
        }

        input[type="file"]::-webkit-file-upload-button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            margin-right: 1rem;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.2s;
        }

        input[type="file"]::-webkit-file-upload-button:hover {
            background: var(--primary-hover);
        }

        .btn {
            width: 100%;
            padding: 1rem;
            border: none;
            border-radius: 0.75rem;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        #generate-btn {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }

        #generate-btn:hover:not(:disabled) {
            background: var(--primary-hover);
            transform: translateY(-2px);
        }

        #generate-btn:disabled {
            background: #cbd5e1;
            cursor: not-allowed;
            box-shadow: none;
        }

        .download-btn {
            background: var(--success);
            color: white;
            margin-top: 1rem;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        .download-btn:hover:not(:disabled) {
            filter: brightness(1.1);
            transform: translateY(-2px);
        }

        .preview-container {
            position: sticky;
            top: 2rem;
        }

        .ad-preview-wrapper {
            background: #f1f5f9;
            border-radius: 1rem;
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 300px;
            border: 2px dashed #cbd5e1;
            margin-bottom: 1.5rem;
            overflow: auto;
        }

        .preview-placeholder {
            text-align: center;
            color: var(--text-muted);
        }

        .ad-info {
            background: #f8fafc;
            border-radius: 1rem;
            padding: 1.5rem;
            border: 1px solid var(--border);
        }

        .ad-info h4 {
            font-size: 1rem;
            margin-bottom: 1rem;
            color: var(--text-main);
            border-bottom: 1px solid var(--border);
            padding-bottom: 0.5rem;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
            font-size: 0.85rem;
        }

        .info-label {
            color: var(--text-muted);
            font-weight: 500;
        }

        .info-value {
            color: var(--text-main);
            font-weight: 600;
            max-width: 180px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .error-message {
            color: #ef4444;
            font-size: 0.8rem;
            margin-top: 0.4rem;
            display: none;
            font-weight: 500;
        }

        @media (max-width: 900px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            .preview-container {
                position: static;
            }
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üé¨ Video Ad Builder</h1>
            <p>Profesional, cepat, dan siap digunakan untuk campaign Anda.</p>
        </header>

        <main class="main-grid">
            <!-- Form Section -->
            <section class="card">
                <h2>üìê Konfigurasi Iklan</h2>
                
                <div class="form-group">
                    <label for="inventory-select">Format Inventori</label>
                    <select id="inventory-select" onchange="onInventoryChange()">
                        <option value="medium-rectangle" data-width="300" data-height="250">Medium Rectangle (300x250)</option>
                        <option value="vob-roll-up" data-width="300" data-height="200">VOB Roll Up (300x200)</option>
                        <option value="vob-pushdown" data-width="320" data-height="480" data-banner-width="320" data-banner-height="300" data-video-width="320" data-video-height="180">VOB Pushdown (320x480)</option>
                        <option value="vob-giant-banner" data-width="300" data-height="600" data-banner-width="300" data-banner-height="431" data-video-width="300" data-video-height="169">VOB Giant Banner (300x600)</option>
                        <option value="vob-billboard" data-width="970" data-height="250" data-banner-width="526" data-banner-height="250" data-video-width="444" data-video-height="250">VOB Billboard (970x250)</option>
                        <option value="vob-top-banner" data-width="300" data-height="250" data-banner-width="300" data-banner-height="80" data-video-width="300" data-video-height="170">VOB Top Banner (300x250)</option>
                        <option value="vob-billboard-custom" data-width="970" data-height="250" data-banner-width="430" data-banner-height="250" data-video-width="540" data-video-height="250">VOB Billboard Custom (Mitsubishi Banten) (970x250)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="youtube-url">YouTube Video URL</label>
                    <input type="url" id="youtube-url" placeholder="https://www.youtube.com/watch?v=..." oninput="validateForm()">
                    <div class="error-message" id="youtube-error">Harap masukkan URL YouTube yang valid</div>
                </div>

                <div class="form-group" id="banner-url-group" style="display: none;">
                    <label for="banner-file-input">Unggah Image Banner</label>
                    <input type="file" id="banner-file-input" accept=".jpg,.jpeg,.png,.gif" onchange="handleBannerUpload()">
                    <div class="error-message" id="banner-error">Hanya mendukung JPG, PNG, atau GIF</div>
                </div>

                <div class="form-group">
                    <label for="landing-page">Landing Page URL (Opsional)</label>
                    <input type="url" id="landing-page" placeholder="https://domain-anda.com" oninput="validateForm()">
                    <div class="error-message" id="landing-error">URL landing page tidak valid</div>
                </div>

                <button class="btn" id="generate-btn" onclick="generatePreview()" disabled>
                    üöÄ Generate Preview
                </button>
            </section>

            <!-- Preview Section -->
            <section class="preview-container">
                <div class="card">
                    <h2>üëÄ Real-time Preview</h2>
                    <div class="ad-preview-wrapper">
                        <div id="ad-preview">
                            <div class="preview-placeholder">
                                <div style="font-size: 3rem; margin-bottom: 1rem;">üì∫</div>
                                <p>Konfigurasikan iklan di sebelah kiri untuk melihat hasilnya di sini.</p>
                            </div>
                        </div>
                    </div>

                    <div class="ad-info" id="ad-info" style="display: none;">
                        <h4>üìä Detail Unit Iklan</h4>
                        <div class="info-item">
                            <span class="info-label">Format:</span>
                            <span class="info-value" id="info-format">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Dimensi:</span>
                            <span class="info-value" id="info-dimensions">-</span>
                        </div>
                        <div class="info-item" id="info-banner-item" style="display: none;">
                            <span class="info-label">Banner:</span>
                            <span class="info-value" id="info-banner-filename">-</span>
                        </div>
                        <div class="info-item" id="info-banner-dimensions-item" style="display: none;">
                            <span class="info-label">Size Banner:</span>
                            <span class="info-value" id="info-banner-dimensions">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Video:</span>
                            <span class="info-value" id="info-video-url">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">LP:</span>
                            <span class="info-value" id="info-landing">-</span>
                        </div>
                    </div>

                    <button class="btn download-btn" id="download-btn" onclick="downloadAdHtml()" disabled>
                        üì• Download HTML Package
                    </button>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Logika JavaScript tetap dipertahankan 100% sama dengan aslinya
        let uploadedBannerBase64 = '';

        function onInventoryChange() {
            const selectElement = document.getElementById('inventory-select');
            const selectedInventoryValue = selectElement.value;
            const bannerUrlGroup = document.getElementById('banner-url-group');
            const bannerFileInput = document.getElementById('banner-file-input');
            const infoBannerItem = document.getElementById('info-banner-item');
            const infoBannerDimensionsItem = document.getElementById('info-banner-dimensions-item');
            const infoVideoDimensionsItem = document.getElementById('info-video-dimensions-item');

            if (['vob-pushdown', 'vob-giant-banner', 'vob-billboard', 'vob-top-banner', 'vob-billboard-custom'].includes(selectedInventoryValue)) {
                bannerUrlGroup.style.display = 'block';
                infoBannerItem.style.display = 'flex';
                infoBannerDimensionsItem.style.display = 'flex';
                // Note: infoVideoDimensionsItem uses the same element name logic in original but displays in ad-info
            } else {
                bannerUrlGroup.style.display = 'none';
                infoBannerItem.style.display = 'none';
                infoBannerDimensionsItem.style.display = 'none';
                bannerFileInput.value = '';
                uploadedBannerBase64 = '';
                document.getElementById('info-banner-filename').textContent = 'Tidak Ada';
                document.getElementById('info-banner-dimensions').textContent = '-';
            }
            updatePreviewContainerDimensions();
            validateForm();
        }

        function handleBannerUpload() {
            const bannerFileInput = document.getElementById('banner-file-input');
            const file = bannerFileInput.files[0];
            const bannerError = document.getElementById('banner-error');

            if (file) {
                const validTypes = ['image/jpeg', 'image/png', 'image/gif'];
                if (!validTypes.includes(file.type)) {
                    bannerError.textContent = 'Jenis file tidak valid. Harap unggah JPG, PNG, atau GIF.';
                    bannerError.style.display = 'block';
                    uploadedBannerBase64 = '';
                    document.getElementById('info-banner-filename').textContent = 'Tidak Valid';
                    validateForm();
                    return;
                }

                const reader = new FileReader();
                reader.onloadend = function() {
                    uploadedBannerBase64 = reader.result;
                    bannerError.style.display = 'none';
                    document.getElementById('info-banner-filename').textContent = file.name;
                    validateForm();
                };
                reader.readAsDataURL(file);
            } else {
                uploadedBannerBase64 = '';
                document.getElementById('info-banner-filename').textContent = 'Tidak Ada';
                validateForm();
            }
        }

        function updatePreviewContainerDimensions() {
            const selectElement = document.getElementById('inventory-select');
            const selectedOption = selectElement.options[selectElement.selectedIndex];
            const width = parseInt(selectedOption.dataset.width, 10);
            const height = parseInt(selectedOption.dataset.height, 10);
            const adPreview = document.getElementById('ad-preview');
            adPreview.style.width = `${width}px`;
            adPreview.style.height = `${height}px`;

            const hasExistingContent = adPreview.querySelector('iframe') || adPreview.querySelector('img');
            if (hasExistingContent) {
                generatePreview();
            }
        }

        function validateForm() {
            const youtubeUrlInput = document.getElementById('youtube-url');
            const landingPageInput = document.getElementById('landing-page');
            const bannerFileInput = document.getElementById('banner-file-input');
            const generateBtn = document.getElementById('generate-btn');
            const downloadBtn = document.getElementById('download-btn');
            const youtubeError = document.getElementById('youtube-error');
            const landingError = document.getElementById('landing-error');
            const bannerError = document.getElementById('banner-error');

            const youtubeUrl = youtubeUrlInput.value.trim();
            const landingPage = landingPageInput.value.trim();
            const selectedInventoryValue = document.getElementById('inventory-select').value;

            let isValid = true;
            const youtubeRegex = /^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/((watch\?v=)|(embed\/)|(v\/)|(.+\/)?)([^#&?]{11}).*/;
            
            if (!youtubeUrl || !youtubeRegex.test(youtubeUrl)) {
                youtubeError.style.display = 'block';
                isValid = false;
            } else {
                youtubeError.style.display = 'none';
            }

            if (['vob-pushdown', 'vob-giant-banner', 'vob-billboard', 'vob-top-banner', 'vob-billboard-custom'].includes(selectedInventoryValue)) {
                if (!bannerFileInput.files[0] || !uploadedBannerBase64) {
                    bannerError.style.display = 'block';
                    isValid = false;
                } else {
                    bannerError.style.display = 'none';
                }
            } else {
                bannerError.style.display = 'none';
            }

            if (landingPage) {
                try { new URL(landingPage); landingError.style.display = 'none'; } 
                catch (e) { landingError.style.display = 'block'; isValid = false; }
            } else {
                landingError.style.display = 'none';
            }

            const isYoutubeValid = youtubeUrl && youtubeRegex.test(youtubeUrl);
            let isBannerRequirementMet = true;
            if (['vob-pushdown', 'vob-giant-banner', 'vob-billboard', 'vob-top-banner', 'vob-billboard-custom'].includes(selectedInventoryValue)) {
                isBannerRequirementMet = uploadedBannerBase64 !== '' && (bannerFileInput.files[0] && ['image/jpeg', 'image/png', 'image/gif'].includes(bannerFileInput.files[0].type));
            }
            
            const canGenerate = isYoutubeValid && isBannerRequirementMet && isValid;
            generateBtn.disabled = !canGenerate;
            downloadBtn.disabled = !canGenerate;
        }

        function getYouTubeVideoId(url) {
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
            const match = url.match(regExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }

        function generatePreview() {
            const youtubeUrl = document.getElementById('youtube-url').value.trim();
            const landingPage = document.getElementById('landing-page').value.trim();
            const bannerFileInput = document.getElementById('banner-file-input');
            const selectElement = document.getElementById('inventory-select');
            const selectedOption = selectElement.options[selectElement.selectedIndex];
            const selectedInventoryName = selectedOption.textContent.split('(')[0].trim();
            const selectedInventoryValue = selectedOption.value;
            const width = parseInt(selectedOption.dataset.width, 10);
            const height = parseInt(selectedOption.dataset.height, 10);
            const bannerWidth = parseInt(selectedOption.dataset.bannerWidth, 10);
            const bannerHeight = parseInt(selectedOption.dataset.bannerHeight, 10);
            const videoWidth = parseInt(selectedOption.dataset.videoWidth, 10);
            const videoHeight = parseInt(selectedOption.dataset.videoHeight, 10);
            const videoId = getYouTubeVideoId(youtubeUrl);

            if (!videoId || (['vob-pushdown', 'vob-giant-banner', 'vob-billboard', 'vob-top-banner', 'vob-billboard-custom'].includes(selectedInventoryValue) && !uploadedBannerBase64)) {
                showMessageBox('Konfigurasi belum lengkap.');
                return;
            }

            const previewContainer = document.getElementById('ad-preview');
            const adInfo = document.getElementById('ad-info');
            previewContainer.innerHTML = '';
            
            const adWrapper = document.createElement('div');
            adWrapper.style.cssText = `width: 100%; height: 100%; cursor: pointer; position: relative; overflow: hidden; display: flex; ${selectedInventoryValue === 'vob-billboard' ? 'flex-direction: row;' : selectedInventoryValue === 'vob-billboard-custom' ? 'flex-direction: row-reverse;' : 'flex-direction: column; align-items: center; justify-content: center;'}`;

            const clickOverlay = document.createElement('div');
            clickOverlay.style.cssText = `position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: transparent; z-index: 2; cursor: pointer;`;
            if (landingPage) { clickOverlay.onclick = () => window.open(landingPage, '_blank'); }

            if (['vob-pushdown', 'vob-giant-banner', 'vob-top-banner', 'vob-billboard', 'vob-billboard-custom'].includes(selectedInventoryValue)) {
                const bannerImg = document.createElement('img');
                bannerImg.src = uploadedBannerBase64;
                bannerImg.style.cssText = `width: ${bannerWidth}px; height: ${bannerHeight}px; display: block; object-fit: cover;`;

                const iframe = document.createElement('iframe');
                iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&controls=0&showinfo=0&rel=0&loop=1&playlist=${videoId}`;
                iframe.style.cssText = `width: ${videoWidth}px; height: ${videoHeight}px; border: none; display: block;`;
                
                if (selectedInventoryValue === 'vob-billboard-custom') {
                    adWrapper.appendChild(iframe);
                    adWrapper.appendChild(bannerImg);
                } else {
                    adWrapper.appendChild(bannerImg);
                    adWrapper.appendChild(iframe);
                }
            } else {
                const iframe = document.createElement('iframe');
                iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&controls=0&showinfo=0&rel=0&loop=1&playlist=${videoId}`;
                iframe.style.cssText = `width: 100%; height: 100%; border: none;`;
                adWrapper.appendChild(iframe);
            }

            adWrapper.appendChild(clickOverlay);
            previewContainer.appendChild(adWrapper);

            // Info Update
            document.getElementById('info-format').textContent = selectedInventoryName;
            document.getElementById('info-dimensions').textContent = `${width}x${height}`;
            document.getElementById('info-video-url').textContent = youtubeUrl;
            document.getElementById('info-landing').textContent = landingPage || 'N/A';
            document.getElementById('info-banner-filename').textContent = bannerFileInput.files[0] ? bannerFileInput.files[0].name : '-';
            
            const isVOBWithBanner = ['vob-pushdown', 'vob-giant-banner', 'vob-billboard', 'vob-top-banner', 'vob-billboard-custom'].includes(selectedInventoryValue);
            document.getElementById('info-banner-item').style.display = isVOBWithBanner ? 'flex' : 'none';
            document.getElementById('info-banner-dimensions-item').style.display = isVOBWithBanner ? 'flex' : 'none';
            if (isVOBWithBanner) {
                document.getElementById('info-banner-dimensions').textContent = `${bannerWidth}x${bannerHeight}`;
            }

            adInfo.style.display = 'block';
        }

        function downloadAdHtml() {
            const youtubeUrl = document.getElementById('youtube-url').value.trim();
            const landingPage = document.getElementById('landing-page').value.trim();
            const videoId = getYouTubeVideoId(youtubeUrl);
            const bannerFileInput = document.getElementById('banner-file-input');

            if (!videoId) return;

            const selectElement = document.getElementById('inventory-select');
            const selectedOption = selectElement.options[selectElement.selectedIndex];
            const width = parseInt(selectedOption.dataset.width, 10);
            const height = parseInt(selectedOption.dataset.height, 10);
            const selectedInventoryName = selectedOption.textContent.split('(')[0].trim();
            const selectedInventoryValue = selectedOption.value;
            const bannerWidth = parseInt(selectedOption.dataset.bannerWidth, 10);
            const bannerHeight = parseInt(selectedOption.dataset.bannerHeight, 10);
            const videoWidth = parseInt(selectedOption.dataset.videoWidth, 10);
            const videoHeight = parseInt(selectedOption.dataset.videoHeight, 10);

            let adContentHtml = '';
            let downloadFileName = `video_ad_${selectedInventoryName.toLowerCase().replace(/\s/g, '_')}_${width}x${height}`;

            if (['vob-pushdown', 'vob-giant-banner', 'vob-billboard', 'vob-top-banner', 'vob-billboard-custom'].includes(selectedInventoryValue)) {
                if (!uploadedBannerBase64 || !bannerFileInput.files[0]) return;
                const originalFileName = bannerFileInput.files[0].name;
                const fileExtension = originalFileName.split('.').pop();
                const bannerFileNameInZip = `banner.${fileExtension}`;

                let bannerHtml = `<img src="./images/${bannerFileNameInZip}" style="width: ${bannerWidth}px; height: ${bannerHeight}px; display: block; object-fit: cover;">`;
                let videoHtml = `<iframe src="https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&controls=0&showinfo=0&rel=0&loop=1&playlist=${videoId}" allow="autoplay; encrypted-media" allowfullscreen style="width: ${videoWidth}px; height: ${videoHeight}px; border: none; display: block;"></iframe>`;
                
                let adContainerFlexDirection = 'column';
                if (selectedInventoryValue === 'vob-billboard') adContainerFlexDirection = 'row';
                else if (selectedInventoryValue === 'vob-billboard-custom') {
                    adContainerFlexDirection = 'row-reverse';
                    const temp = bannerHtml; bannerHtml = videoHtml; videoHtml = temp;
                }

                adContentHtml = `<!DOCTYPE html><html><head><meta charset="UTF-8"><style>body{margin:0;overflow:hidden;display:flex;justify-content:center;align-items:center;width:100vw;height:100vh;}.ad-container{width:${width}px;height:${height}px;position:relative;overflow:hidden;display:flex;flex-direction:${adContainerFlexDirection};}.click-overlay{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1;cursor:pointer;background:transparent;}</style></head><body><div class="ad-container">${bannerHtml}${videoHtml}${landingPage ? `<a href="${landingPage}" target="_blank" class="click-overlay"></a>` : `<div class="click-overlay"></div>`}</div></body></html>`;

                const zip = new JSZip();
                zip.file("index.html", adContentHtml);
                const base64Data = uploadedBannerBase64.split(',')[1];
                zip.folder("images").file(bannerFileNameInZip, base64Data, { base64: true });
                zip.generateAsync({ type: "blob" }).then(content => {
                    const url = URL.createObjectURL(content);
                    const a = document.createElement('a'); a.href = url; a.download = downloadFileName + '.zip';
                    a.click(); URL.revokeObjectURL(url);
                    showMessageBox('ZIP Package Berhasil Diunduh!');
                });
            } else {
                adContentHtml = `<!DOCTYPE html><html><head><meta charset="UTF-8"><style>body{margin:0;overflow:hidden;display:flex;justify-content:center;align-items:center;width:100vw;height:100vh;}.ad-container{width:${width}px;height:${height}px;position:relative;overflow:hidden;}iframe{width:100%;height:100%;border:none;}.click-overlay{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1;cursor:pointer;background:transparent;}</style></head><body><div class="ad-container"><iframe src="https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&controls=0&showinfo=0&rel=0&loop=1&playlist=${videoId}" allow="autoplay; encrypted-media" allowfullscreen></iframe>${landingPage ? `<a href="${landingPage}" target="_blank" class="click-overlay"></a>` : `<div class="click-overlay"></div>`}</div></body></html>`;
                const blob = new Blob([adContentHtml], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a'); a.href = url; a.download = downloadFileName + '.html';
                a.click(); URL.revokeObjectURL(url);
                showMessageBox('HTML File Berhasil Diunduh!');
            }
        }

        function showMessageBox(message) {
            const messageBoxId = 'customMessageBox';
            let messageBox = document.getElementById(messageBoxId);
            if (!messageBox) {
                messageBox = document.createElement('div');
                messageBox.id = messageBoxId;
                messageBox.style.cssText = `position: fixed; top: 20px; right: 20px; background: white; padding: 1rem 1.5rem; border-radius: 1rem; box-shadow: var(--shadow); z-index: 9999; border-left: 5px solid var(--primary); font-size: 0.9rem; transform: translateX(120%); transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);`;
                document.body.appendChild(messageBox);
            }
            messageBox.innerHTML = message;
            setTimeout(() => messageBox.style.transform = 'translateX(0)', 100);
            setTimeout(() => messageBox.style.transform = 'translateX(120%)', 4000);
        }

        document.addEventListener('DOMContentLoaded', () => {
            const selectElement = document.getElementById('inventory-select');
            selectElement.value = 'medium-rectangle';
            onInventoryChange();
        });
    </script>
</body>
</html>